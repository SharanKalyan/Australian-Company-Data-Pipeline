[0m16:43:38.813117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7EF42810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7DFF8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7EF43BD0>]}


============================== 16:43:38.813117 | 58979ac9-3bf5-4628-b500-ef66434297de ==============================
[0m16:43:38.813117 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:43:38.823372 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:43:38.859896 [info ] [MainThread]: dbt version: 1.11.5
[0m16:43:38.865169 [info ] [MainThread]: python version: 3.11.14
[0m16:43:38.865169 [info ] [MainThread]: python path: C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\python.exe
[0m16:43:38.865169 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m16:43:38.947439 [info ] [MainThread]: Using profiles dir at C:\Users\Sharan Kalyan\.dbt
[0m16:43:38.947439 [info ] [MainThread]: Using profiles.yml file at C:\Users\Sharan Kalyan\.dbt\profiles.yml
[0m16:43:38.947439 [info ] [MainThread]: Using dbt_project.yml file at G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\dbt_project.yml
[0m16:43:38.955129 [info ] [MainThread]: adapter type: postgres
[0m16:43:38.957786 [info ] [MainThread]: adapter version: 1.10.0
[0m16:43:39.089919 [info ] [MainThread]: Configuration:
[0m16:43:39.089919 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:43:39.089919 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:43:39.096917 [info ] [MainThread]: Required dependencies:
[0m16:43:39.100121 [debug] [MainThread]: Executing "git --help"
[0m16:43:39.112890 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:43:39.112890 [info ] [MainThread]: Connection:
[0m16:43:39.112890 [info ] [MainThread]:   host: localhost
[0m16:43:39.121007 [info ] [MainThread]:   port: 5432
[0m16:43:39.121007 [info ] [MainThread]:   user: postgres
[0m16:43:39.121007 [info ] [MainThread]:   database: firmable_db
[0m16:43:39.121007 [info ] [MainThread]:   schema: staging
[0m16:43:39.121007 [info ] [MainThread]:   connect_timeout: 10
[0m16:43:39.121007 [info ] [MainThread]:   role: None
[0m16:43:39.121007 [info ] [MainThread]:   search_path: None
[0m16:43:39.128692 [info ] [MainThread]:   keepalives_idle: 0
[0m16:43:39.131412 [info ] [MainThread]:   sslmode: None
[0m16:43:39.131412 [info ] [MainThread]:   sslcert: None
[0m16:43:39.131412 [info ] [MainThread]:   sslkey: None
[0m16:43:39.131412 [info ] [MainThread]:   sslrootcert: None
[0m16:43:39.131412 [info ] [MainThread]:   application_name: dbt
[0m16:43:39.131412 [info ] [MainThread]:   retries: 1
[0m16:43:39.131412 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:43:39.570435 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:43:40.030619 [debug] [MainThread]: Using postgres connection "debug"
[0m16:43:40.030619 [debug] [MainThread]: On debug: select 1 as id
[0m16:43:40.030619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:40.103501 [debug] [MainThread]: SQL status: SELECT 1 in 0.070 seconds
[0m16:43:40.106890 [debug] [MainThread]: On debug: Close
[0m16:43:40.106890 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:43:40.110260 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:43:40.110260 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m16:43:40.113855 [debug] [MainThread]: Command `dbt debug` failed at 16:43:40.113855 after 1.40 seconds
[0m16:43:40.113855 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:43:40.113855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB00112650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB782753D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ECD9790>]}
[0m16:43:40.113855 [debug] [MainThread]: Flushing usage events
[0m16:43:41.652519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:49.455355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013241C03350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013241C63D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001323EB01C90>]}


============================== 16:47:49.455355 | c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e ==============================
[0m16:47:49.455355 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:47:49.455355 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:47:49.708348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013242DD55D0>]}
[0m16:47:49.777689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001323E40CC90>]}
[0m16:47:49.779693 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:47:50.136839 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m16:47:50.136839 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:47:50.136839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013242E35BD0>]}
[0m16:47:51.544359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132433B9910>]}
[0m16:47:51.623896 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:47:51.623896 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:47:51.655249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001324363DB90>]}
[0m16:47:51.655249 [info ] [MainThread]: Found 4 models, 8 data tests, 464 macros
[0m16:47:51.655249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132435056D0>]}
[0m16:47:51.669754 [info ] [MainThread]: 
[0m16:47:51.671267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:51.671267 [info ] [MainThread]: 
[0m16:47:51.671267 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:51.677138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db'
[0m16:47:51.892611 [debug] [ThreadPool]: Using postgres connection "list_firmable_db"
[0m16:47:51.892611 [debug] [ThreadPool]: On list_firmable_db: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db"} */

    select distinct nspname from pg_namespace
  
[0m16:47:51.892611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:51.924799 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m16:47:51.924799 [debug] [ThreadPool]: On list_firmable_db: Close
[0m16:47:51.940644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m16:47:51.940644 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m16:47:51.940644 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:47:51.940644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:51.988276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m16:47:51.988276 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m16:47:51.988276 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m16:47:51.988276 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:51.988276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:47:52.004238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:52.035959 [debug] [MainThread]: SQL status: SELECT 0 in 0.040 seconds
[0m16:47:52.035959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001324139B4D0>]}
[0m16:47:52.035959 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:52.035959 [debug] [MainThread]: On master: COMMIT
[0m16:47:52.035959 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:52.035959 [debug] [MainThread]: On master: COMMIT
[0m16:47:52.035959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:47:52.035959 [debug] [MainThread]: On master: Close
[0m16:47:52.051902 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m16:47:52.051902 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m16:47:52.051902 [debug] [Thread-3 (]: Began running node model.firmable_dbt.my_first_dbt_model
[0m16:47:52.051902 [info ] [Thread-1 (]: 1 of 4 START sql view model staging.abr_clean .................................. [RUN]
[0m16:47:52.051902 [info ] [Thread-2 (]: 2 of 4 START sql view model staging.commoncrawl_clean .......................... [RUN]
[0m16:47:52.051902 [info ] [Thread-3 (]: 3 of 4 START sql table model staging.my_first_dbt_model ........................ [RUN]
[0m16:47:52.051902 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m16:47:52.051902 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m16:47:52.051902 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.firmable_dbt.my_first_dbt_model'
[0m16:47:52.051902 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m16:47:52.051902 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m16:47:52.051902 [debug] [Thread-3 (]: Began compiling node model.firmable_dbt.my_first_dbt_model
[0m16:47:52.067581 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m16:47:52.067581 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.067581 [debug] [Thread-3 (]: Writing injected SQL for node "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.067581 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m16:47:52.067581 [debug] [Thread-3 (]: Began executing node model.firmable_dbt.my_first_dbt_model
[0m16:47:52.067581 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m16:47:52.115087 [debug] [Thread-1 (]: Writing runtime sql for node "model.firmable_dbt.abr_clean"
[0m16:47:52.130948 [debug] [Thread-3 (]: Writing runtime sql for node "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.142945 [debug] [Thread-2 (]: Writing runtime sql for node "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.146649 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:47:52.146649 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.146649 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */

  create view "firmable_db"."staging"."abr_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from staging.abr_raw

)

select
    abn,
    initcap(trim(entity_name)) as entity_name,
    lower(regexp_replace(entity_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    entity_type,
    entity_status,
    state,
    postcode
from source
where entity_status = 'ACT'
  );
[0m16:47:52.146649 [debug] [Thread-3 (]: Using postgres connection "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.146649 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */

  create view "firmable_db"."staging"."commoncrawl_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from staging.commoncrawl_raw

)

select
    website_url,
    initcap(trim(company_name)) as company_name,
    lower(regexp_replace(company_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    industry
from source
where company_name is not null
  );
[0m16:47:52.146649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:47:52.146649 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_first_dbt_model"} */

  
    

  create  table "firmable_db"."staging"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:47:52.146649 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:47:52.146649 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:47:52.240091 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.093 seconds
[0m16:47:52.253970 [debug] [Thread-3 (]: Using postgres connection "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.253970 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_first_dbt_model"} */
alter table "firmable_db"."staging"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:47:52.261068 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:47:52.277256 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: COMMIT
[0m16:47:52.277256 [debug] [Thread-3 (]: Using postgres connection "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.277256 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: COMMIT
[0m16:47:52.282433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:52.290265 [debug] [Thread-3 (]: Applying DROP to: "firmable_db"."staging"."my_first_dbt_model__dbt_backup"
[0m16:47:52.290265 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.139 seconds
[0m16:47:52.291225 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.141 seconds
[0m16:47:52.294728 [debug] [Thread-3 (]: Using postgres connection "model.firmable_dbt.my_first_dbt_model"
[0m16:47:52.294728 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.302226 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:47:52.302226 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_first_dbt_model"} */
drop table if exists "firmable_db"."staging"."my_first_dbt_model__dbt_backup" cascade
[0m16:47:52.302226 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean" rename to "commoncrawl_clean__dbt_backup"
[0m16:47:52.302226 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean" rename to "abr_clean__dbt_backup"
[0m16:47:52.302226 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:52.302226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:52.302226 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:47:52.310396 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.313337 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:47:52.313337 [debug] [Thread-3 (]: On model.firmable_dbt.my_first_dbt_model: Close
[0m16:47:52.313337 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean__dbt_tmp" rename to "commoncrawl_clean"
[0m16:47:52.313337 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean__dbt_tmp" rename to "abr_clean"
[0m16:47:52.313337 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132439995D0>]}
[0m16:47:52.313337 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:47:52.313337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:47:52.313337 [info ] [Thread-3 (]: 3 of 4 OK created sql table model staging.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.26s]
[0m16:47:52.326078 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m16:47:52.326078 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m16:47:52.326078 [debug] [Thread-3 (]: Finished running node model.firmable_dbt.my_first_dbt_model
[0m16:47:52.326078 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.326078 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:47:52.326078 [debug] [Thread-4 (]: Began running node model.firmable_dbt.my_second_dbt_model
[0m16:47:52.326078 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m16:47:52.326078 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m16:47:52.326078 [info ] [Thread-4 (]: 4 of 4 START sql view model staging.my_second_dbt_model ........................ [RUN]
[0m16:47:52.326078 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.firmable_dbt.my_second_dbt_model'
[0m16:47:52.326078 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:52.326078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:52.326078 [debug] [Thread-4 (]: Began compiling node model.firmable_dbt.my_second_dbt_model
[0m16:47:52.326078 [debug] [Thread-2 (]: Applying DROP to: "firmable_db"."staging"."commoncrawl_clean__dbt_backup"
[0m16:47:52.341959 [debug] [Thread-1 (]: Applying DROP to: "firmable_db"."staging"."abr_clean__dbt_backup"
[0m16:47:52.341959 [debug] [Thread-4 (]: Writing injected SQL for node "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.341959 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:47:52.341959 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:47:52.341959 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
drop table if exists "firmable_db"."staging"."commoncrawl_clean__dbt_backup" cascade
[0m16:47:52.341959 [debug] [Thread-4 (]: Began executing node model.firmable_dbt.my_second_dbt_model
[0m16:47:52.341959 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
drop table if exists "firmable_db"."staging"."abr_clean__dbt_backup" cascade
[0m16:47:52.357735 [debug] [Thread-4 (]: Writing runtime sql for node "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.357735 [debug] [Thread-4 (]: Using postgres connection "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.357735 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_second_dbt_model"} */

  create view "firmable_db"."staging"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "firmable_db"."staging"."my_first_dbt_model"
where id = 1
  );
[0m16:47:52.357735 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:47:52.389652 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.042 seconds
[0m16:47:52.389652 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: Close
[0m16:47:52.389652 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013243EE5DD0>]}
[0m16:47:52.389652 [info ] [Thread-2 (]: 2 of 4 OK created sql view model staging.commoncrawl_clean ..................... [[32mCREATE VIEW[0m in 0.34s]
[0m16:47:52.389652 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m16:47:52.389652 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m16:47:52.389652 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: Close
[0m16:47:52.405468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013243EE70D0>]}
[0m16:47:52.407475 [info ] [Thread-1 (]: 1 of 4 OK created sql view model staging.abr_clean ............................. [[32mCREATE VIEW[0m in 0.35s]
[0m16:47:52.407475 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m16:47:52.421352 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.054 seconds
[0m16:47:52.468872 [debug] [Thread-4 (]: Using postgres connection "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.468872 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_second_dbt_model"} */
alter table "firmable_db"."staging"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:47:52.468872 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:47:52.484731 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: COMMIT
[0m16:47:52.484731 [debug] [Thread-4 (]: Using postgres connection "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.484731 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: COMMIT
[0m16:47:52.484731 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:47:52.484731 [debug] [Thread-4 (]: Applying DROP to: "firmable_db"."staging"."my_second_dbt_model__dbt_backup"
[0m16:47:52.484731 [debug] [Thread-4 (]: Using postgres connection "model.firmable_dbt.my_second_dbt_model"
[0m16:47:52.484731 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.my_second_dbt_model"} */
drop view if exists "firmable_db"."staging"."my_second_dbt_model__dbt_backup" cascade
[0m16:47:52.484731 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:47:52.484731 [debug] [Thread-4 (]: On model.firmable_dbt.my_second_dbt_model: Close
[0m16:47:52.484731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8afa98c-d2c5-4c62-a5b8-2d65a3f18c6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013243EE7950>]}
[0m16:47:52.484731 [info ] [Thread-4 (]: 4 of 4 OK created sql view model staging.my_second_dbt_model ................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:47:52.500579 [debug] [Thread-4 (]: Finished running node model.firmable_dbt.my_second_dbt_model
[0m16:47:52.500579 [debug] [MainThread]: On master: COMMIT
[0m16:47:52.500579 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:52.504539 [debug] [MainThread]: On master: COMMIT
[0m16:47:52.504539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:52.532128 [debug] [MainThread]: SQL status: COMMIT in 0.036 seconds
[0m16:47:52.532128 [debug] [MainThread]: On master: Close
[0m16:47:52.532128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'list_firmable_db' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'model.firmable_dbt.abr_clean' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'model.firmable_dbt.commoncrawl_clean' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'model.firmable_dbt.my_first_dbt_model' was properly closed.
[0m16:47:52.532128 [debug] [MainThread]: Connection 'model.firmable_dbt.my_second_dbt_model' was properly closed.
[0m16:47:52.532128 [info ] [MainThread]: 
[0m16:47:52.547890 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:47:52.547890 [debug] [MainThread]: Command end result
[0m16:47:52.563901 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:47:52.563901 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:47:52.579800 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m16:47:52.579800 [info ] [MainThread]: 
[0m16:47:52.579800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:52.579800 [info ] [MainThread]: 
[0m16:47:52.579800 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:47:52.579800 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:52.579800 after 3.23 seconds
[0m16:47:52.579800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001323B15F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001324346DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013243EC9210>]}
[0m16:47:52.579800 [debug] [MainThread]: Flushing usage events
[0m16:47:53.875056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:04.374619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4A10E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4A126D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4A10C50>]}


============================== 16:48:04.390520 | 47156e89-8abe-415a-9cbd-aa3765680ff2 ==============================
[0m16:48:04.390520 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:48:04.390520 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:48:04.580495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4A7A890>]}
[0m16:48:04.643868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD1222C50>]}
[0m16:48:04.643868 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:48:04.976113 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m16:48:05.166400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:05.168283 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:48:05.168283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:05.198325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD5FBD650>]}
[0m16:48:05.277209 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:48:05.277209 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:48:05.324481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD6210DD0>]}
[0m16:48:05.324481 [info ] [MainThread]: Found 4 models, 8 data tests, 464 macros
[0m16:48:05.324481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD61EAED0>]}
[0m16:48:05.324481 [info ] [MainThread]: 
[0m16:48:05.324481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:05.324481 [info ] [MainThread]: 
[0m16:48:05.324481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:05.340369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m16:48:05.602619 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m16:48:05.603043 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:48:05.604175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:05.654560 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m16:48:05.654560 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m16:48:05.654560 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m16:48:05.654560 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:05.654560 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:48:05.654560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:05.706119 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m16:48:05.708088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47156e89-8abe-415a-9cbd-aa3765680ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECD4A78D50>]}
[0m16:48:05.709087 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:05.710087 [debug] [MainThread]: On master: COMMIT
[0m16:48:05.710087 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:05.710087 [debug] [MainThread]: On master: COMMIT
[0m16:48:05.710087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:48:05.710087 [debug] [MainThread]: On master: Close
[0m16:48:05.710087 [debug] [Thread-1 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:48:05.710087 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:48:05.710087 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:48:05.710087 [debug] [Thread-4 (]: Began running node test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:48:05.710087 [info ] [Thread-1 (]: 1 of 8 START test not_null_abr_clean_abn ....................................... [RUN]
[0m16:48:05.710087 [info ] [Thread-2 (]: 2 of 8 START test not_null_abr_clean_normalized_name ........................... [RUN]
[0m16:48:05.710087 [info ] [Thread-3 (]: 3 of 8 START test not_null_commoncrawl_clean_website_url ....................... [RUN]
[0m16:48:05.710087 [info ] [Thread-4 (]: 4 of 8 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:48:05.710087 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m16:48:05.710087 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m16:48:05.725756 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377'
[0m16:48:05.725756 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m16:48:05.725756 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:48:05.725756 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:48:05.725756 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:48:05.725756 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:48:05.741414 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:48:05.741414 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:48:05.741414 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:48:05.757427 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:48:05.757427 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:48:05.757427 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:48:05.757427 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:48:05.757427 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:48:05.773400 [debug] [Thread-1 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:48:05.773400 [debug] [Thread-4 (]: Writing runtime sql for node "test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:48:05.773400 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:48:05.789073 [debug] [Thread-2 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:48:05.789073 [debug] [Thread-1 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:48:05.789073 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:48:05.789073 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select abn
from "firmable_db"."staging"."abr_clean"
where abn is null



  
  
      
    ) dbt_internal_test
[0m16:48:05.789073 [debug] [Thread-2 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:48:05.789073 [debug] [Thread-4 (]: Using postgres connection "test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:48:05.789073 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select website_url
from "firmable_db"."staging"."commoncrawl_clean"
where website_url is null



  
  
      
    ) dbt_internal_test
[0m16:48:05.789073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:05.789073 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normalized_name
from "firmable_db"."staging"."abr_clean"
where normalized_name is null



  
  
      
    ) dbt_internal_test
[0m16:48:05.789073 [debug] [Thread-4 (]: On test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "firmable_db"."staging"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m16:48:05.789073 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:05.789073 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:05.789073 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:05.839912 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:48:05.856771 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: ROLLBACK
[0m16:48:05.856771 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: Close
[0m16:48:05.858779 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.058 seconds
[0m16:48:05.858779 [info ] [Thread-3 (]: 3 of 8 PASS not_null_commoncrawl_clean_website_url ............................. [[32mPASS[0m in 0.15s]
[0m16:48:05.862406 [debug] [Thread-4 (]: On test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m16:48:05.864414 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:48:05.866421 [debug] [Thread-4 (]: On test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m16:48:05.867428 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m16:48:05.871442 [error] [Thread-4 (]: 4 of 8 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.14s]
[0m16:48:05.871442 [info ] [Thread-3 (]: 5 of 8 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:48:05.873450 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:48:05.875458 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377, now test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m16:48:05.875458 [debug] [Thread-4 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:48:05.877466 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m16:48:05.877466 [info ] [Thread-4 (]: 6 of 8 START test unique_abr_clean_abn ......................................... [RUN]
[0m16:48:05.887280 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m16:48:05.889296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.firmable_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9)
[0m16:48:05.891318 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:48:05.905119 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:48:05.905119 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m16:48:05.910915 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m16:48:05.910915 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:48:05.915063 [debug] [Thread-4 (]: Writing runtime sql for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:48:05.915063 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m16:48:05.915063 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "firmable_db"."staging"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m16:48:05.915063 [debug] [Thread-4 (]: Using postgres connection "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:48:05.915063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:05.922925 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    abn as unique_field,
    count(*) as n_records

from "firmable_db"."staging"."abr_clean"
where abn is not null
group by abn
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:48:05.922925 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:05.971641 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:48:05.974747 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m16:48:05.975745 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:48:05.976747 [info ] [Thread-3 (]: 5 of 8 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
[0m16:48:05.978644 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m16:48:05.980618 [debug] [Thread-3 (]: Began running node test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321
[0m16:48:05.980618 [info ] [Thread-3 (]: 7 of 8 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:48:05.980618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.firmable_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m16:48:05.980618 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321
[0m16:48:05.980618 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m16:48:05.980618 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321
[0m16:48:05.993558 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m16:48:05.993558 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m16:48:05.993558 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "firmable_db"."staging"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:48:05.993558 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:06.041215 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.043 seconds
[0m16:48:06.041215 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m16:48:06.041215 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m16:48:06.049456 [info ] [Thread-3 (]: 7 of 8 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
[0m16:48:06.049456 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321
[0m16:48:06.052744 [debug] [Thread-3 (]: Began running node test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m16:48:06.052744 [info ] [Thread-3 (]: 8 of 8 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:48:06.054754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.firmable_dbt.unique_my_first_dbt_model_id.16e066b321, now test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m16:48:06.056763 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m16:48:06.056763 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:48:06.056763 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m16:48:06.056763 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:48:06.056763 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:48:06.072573 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "firmable_db"."staging"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:48:06.072573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:06.104359 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.312 seconds
[0m16:48:06.104359 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.309 seconds
[0m16:48:06.104359 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: ROLLBACK
[0m16:48:06.104359 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: ROLLBACK
[0m16:48:06.104359 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: Close
[0m16:48:06.104359 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: Close
[0m16:48:06.104359 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.042 seconds
[0m16:48:06.104359 [info ] [Thread-1 (]: 1 of 8 PASS not_null_abr_clean_abn ............................................. [[32mPASS[0m in 0.39s]
[0m16:48:06.104359 [error] [Thread-2 (]: 2 of 8 FAIL 101955 not_null_abr_clean_normalized_name .......................... [[31mFAIL 101955[0m in 0.39s]
[0m16:48:06.120213 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m16:48:06.120213 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:48:06.120213 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:48:06.120213 [debug] [Thread-3 (]: On test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:48:06.120213 [info ] [Thread-3 (]: 8 of 8 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
[0m16:48:06.120213 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m16:48:06.247256 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.327 seconds
[0m16:48:06.247256 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: ROLLBACK
[0m16:48:06.247256 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: Close
[0m16:48:06.247256 [info ] [Thread-4 (]: 6 of 8 PASS unique_abr_clean_abn ............................................... [[32mPASS[0m in 0.36s]
[0m16:48:06.247256 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:48:06.247256 [debug] [MainThread]: On master: COMMIT
[0m16:48:06.247256 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:06.247256 [debug] [MainThread]: On master: COMMIT
[0m16:48:06.247256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:06.279289 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m16:48:06.295261 [debug] [MainThread]: On master: Close
[0m16:48:06.295261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:06.295261 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m16:48:06.295261 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m16:48:06.295261 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m16:48:06.295261 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:48:06.295261 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m16:48:06.295261 [info ] [MainThread]: 
[0m16:48:06.295261 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m16:48:06.295261 [debug] [MainThread]: Command end result
[0m16:48:06.326944 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:48:06.326944 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:48:06.326944 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m16:48:06.326944 [info ] [MainThread]: 
[0m16:48:06.342973 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:48:06.342973 [info ] [MainThread]: 
[0m16:48:06.342973 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m16:48:06.342973 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:48:06.342973 [info ] [MainThread]: 
[0m16:48:06.342973 [info ] [MainThread]:   compiled code at target\compiled\firmable_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m16:48:06.342973 [info ] [MainThread]: 
[0m16:48:06.342973 [error] [MainThread]: [31mFailure in test not_null_abr_clean_normalized_name (models\staging\schema.yml)[0m
[0m16:48:06.342973 [error] [MainThread]:   Got 101955 results, configured to fail if != 0
[0m16:48:06.342973 [info ] [MainThread]: 
[0m16:48:06.342973 [info ] [MainThread]:   compiled code at target\compiled\firmable_dbt\models\staging\schema.yml\not_null_abr_clean_normalized_name.sql
[0m16:48:06.342973 [info ] [MainThread]: 
[0m16:48:06.342973 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=8
[0m16:48:06.342973 [debug] [MainThread]: Command `dbt test` failed at 16:48:06.342973 after 2.05 seconds
[0m16:48:06.342973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCDC95350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCDC95190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECCDC950D0>]}
[0m16:48:06.359055 [debug] [MainThread]: Flushing usage events
[0m16:48:07.581960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:03.263811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A85FF3A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A86025B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A860276D0>]}


============================== 16:53:03.277876 | 8d427361-a664-4dc7-b656-8430673a0751 ==============================
[0m16:53:03.277876 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:53:03.279624 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:53:03.468357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A85CA8810>]}
[0m16:53:03.532195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A87102CD0>]}
[0m16:53:03.532195 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:53:03.873807 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m16:53:04.051138 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m16:53:04.052642 [debug] [MainThread]: Partial parsing: deleted file: firmable_dbt://models\example\my_first_dbt_model.sql
[0m16:53:04.052642 [debug] [MainThread]: Partial parsing: deleted file: firmable_dbt://models\example\my_second_dbt_model.sql
[0m16:53:04.054648 [debug] [MainThread]: Partial parsing: updated file: firmable_dbt://models\staging\abr_clean.sql
[0m16:53:04.480033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.firmable_dbt.example
[0m16:53:04.495800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A875AE750>]}
[0m16:53:04.559600 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:53:04.559600 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:53:04.604434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A874B8A50>]}
[0m16:53:04.606440 [info ] [MainThread]: Found 2 models, 4 data tests, 464 macros
[0m16:53:04.606440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A874DF390>]}
[0m16:53:04.606440 [info ] [MainThread]: 
[0m16:53:04.606440 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:04.606440 [info ] [MainThread]: 
[0m16:53:04.606440 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:04.606440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db'
[0m16:53:04.828258 [debug] [ThreadPool]: Using postgres connection "list_firmable_db"
[0m16:53:04.828258 [debug] [ThreadPool]: On list_firmable_db: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db"} */

    select distinct nspname from pg_namespace
  
[0m16:53:04.828258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:04.875718 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m16:53:04.875718 [debug] [ThreadPool]: On list_firmable_db: Close
[0m16:53:04.875718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m16:53:04.875718 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m16:53:04.875718 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:53:04.875718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:04.923504 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m16:53:04.923504 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m16:53:04.923504 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m16:53:04.923504 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:04.939247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:53:04.939247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:04.978940 [debug] [MainThread]: SQL status: SELECT 3 in 0.039 seconds
[0m16:53:04.978940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A84FDAF50>]}
[0m16:53:04.978940 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:04.978940 [debug] [MainThread]: On master: COMMIT
[0m16:53:04.978940 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:04.978940 [debug] [MainThread]: On master: COMMIT
[0m16:53:04.984727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:53:04.984727 [debug] [MainThread]: On master: Close
[0m16:53:04.986868 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m16:53:04.986868 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m16:53:04.986868 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.abr_clean .................................. [RUN]
[0m16:53:04.986868 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.commoncrawl_clean .......................... [RUN]
[0m16:53:04.986868 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m16:53:04.986868 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m16:53:04.986868 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m16:53:04.986868 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m16:53:05.002644 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m16:53:05.006317 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.006317 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m16:53:05.006317 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m16:53:05.034518 [debug] [Thread-1 (]: Writing runtime sql for node "model.firmable_dbt.abr_clean"
[0m16:53:05.045342 [debug] [Thread-2 (]: Writing runtime sql for node "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.047347 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:53:05.047347 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */

  create view "firmable_db"."staging"."abr_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from staging.abr_raw

)

select
    abn,
    initcap(trim(entity_name)) as entity_name,
    lower(regexp_replace(entity_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    entity_type,
    entity_status,
    state,
    postcode
from source
where entity_status = 'ACT'
  and entity_name is not null
  and trim(entity_name) <> ''
  );
[0m16:53:05.047347 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.047347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:05.050348 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */

  create view "firmable_db"."staging"."commoncrawl_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from staging.commoncrawl_raw

)

select
    website_url,
    initcap(trim(company_name)) as company_name,
    lower(regexp_replace(company_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    industry
from source
where company_name is not null
  );
[0m16:53:05.050348 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:53:05.114290 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.069 seconds
[0m16:53:05.114290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.071 seconds
[0m16:53:05.127642 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.130242 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:53:05.130242 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean" rename to "commoncrawl_clean__dbt_backup"
[0m16:53:05.130242 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean" rename to "abr_clean__dbt_backup"
[0m16:53:05.130242 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:05.130242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:05.138882 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.138882 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:53:05.138882 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean__dbt_tmp" rename to "commoncrawl_clean"
[0m16:53:05.138882 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean__dbt_tmp" rename to "abr_clean"
[0m16:53:05.138882 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:53:05.138882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:05.146349 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m16:53:05.162356 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m16:53:05.162356 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.162356 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:53:05.162356 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m16:53:05.162356 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m16:53:05.162356 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:53:05.162356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:53:05.174826 [debug] [Thread-2 (]: Applying DROP to: "firmable_db"."staging"."commoncrawl_clean__dbt_backup"
[0m16:53:05.174826 [debug] [Thread-1 (]: Applying DROP to: "firmable_db"."staging"."abr_clean__dbt_backup"
[0m16:53:05.182489 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m16:53:05.182489 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m16:53:05.182489 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
drop view if exists "firmable_db"."staging"."commoncrawl_clean__dbt_backup" cascade
[0m16:53:05.182489 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
drop view if exists "firmable_db"."staging"."abr_clean__dbt_backup" cascade
[0m16:53:05.182489 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:53:05.182489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:53:05.190771 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: Close
[0m16:53:05.190771 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: Close
[0m16:53:05.194340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A877C2590>]}
[0m16:53:05.194340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d427361-a664-4dc7-b656-8430673a0751', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A87821B90>]}
[0m16:53:05.194340 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.commoncrawl_clean ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m16:53:05.194340 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m16:53:05.194340 [info ] [Thread-1 (]: 1 of 2 OK created sql view model staging.abr_clean ............................. [[32mCREATE VIEW[0m in 0.21s]
[0m16:53:05.194340 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m16:53:05.194340 [debug] [MainThread]: On master: COMMIT
[0m16:53:05.194340 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:05.204699 [debug] [MainThread]: On master: COMMIT
[0m16:53:05.204699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:05.235642 [debug] [MainThread]: SQL status: COMMIT in 0.034 seconds
[0m16:53:05.235642 [debug] [MainThread]: On master: Close
[0m16:53:05.235642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:05.241469 [debug] [MainThread]: Connection 'list_firmable_db' was properly closed.
[0m16:53:05.241469 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m16:53:05.241469 [debug] [MainThread]: Connection 'model.firmable_dbt.abr_clean' was properly closed.
[0m16:53:05.241469 [debug] [MainThread]: Connection 'model.firmable_dbt.commoncrawl_clean' was properly closed.
[0m16:53:05.241469 [info ] [MainThread]: 
[0m16:53:05.241469 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m16:53:05.241469 [debug] [MainThread]: Command end result
[0m16:53:05.257538 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:53:05.273359 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:53:05.273359 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m16:53:05.273359 [info ] [MainThread]: 
[0m16:53:05.273359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:05.273359 [info ] [MainThread]: 
[0m16:53:05.273359 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:53:05.273359 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:05.273359 after 2.09 seconds
[0m16:53:05.273359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFF5AF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A8605F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A8605C190>]}
[0m16:53:05.289471 [debug] [MainThread]: Flushing usage events
[0m16:53:06.495469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:26.103717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174592633D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017458FFA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001745820EB90>]}


============================== 16:53:26.109744 | fa065184-8b3a-4a01-bfb6-f61c9856d347 ==============================
[0m16:53:26.109744 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:53:26.110308 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:53:26.135821 [info ] [MainThread]: dbt version: 1.11.5
[0m16:53:26.136823 [info ] [MainThread]: python version: 3.11.14
[0m16:53:26.137185 [info ] [MainThread]: python path: C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\python.exe
[0m16:53:26.138193 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m16:53:26.204509 [info ] [MainThread]: Using profiles dir at C:\Users\Sharan Kalyan\.dbt
[0m16:53:26.205553 [info ] [MainThread]: Using profiles.yml file at C:\Users\Sharan Kalyan\.dbt\profiles.yml
[0m16:53:26.206556 [info ] [MainThread]: Using dbt_project.yml file at G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\dbt_project.yml
[0m16:53:26.207552 [info ] [MainThread]: adapter type: postgres
[0m16:53:26.209622 [info ] [MainThread]: adapter version: 1.10.0
[0m16:53:26.316335 [info ] [MainThread]: Configuration:
[0m16:53:26.316335 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:53:26.316335 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:53:26.316335 [info ] [MainThread]: Required dependencies:
[0m16:53:26.316335 [debug] [MainThread]: Executing "git --help"
[0m16:53:26.335877 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:53:26.335877 [info ] [MainThread]: Connection:
[0m16:53:26.335877 [info ] [MainThread]:   host: localhost
[0m16:53:26.335877 [info ] [MainThread]:   port: 5432
[0m16:53:26.335877 [info ] [MainThread]:   user: postgres
[0m16:53:26.335877 [info ] [MainThread]:   database: firmable_db
[0m16:53:26.335877 [info ] [MainThread]:   schema: staging
[0m16:53:26.335877 [info ] [MainThread]:   connect_timeout: 10
[0m16:53:26.335877 [info ] [MainThread]:   role: None
[0m16:53:26.335877 [info ] [MainThread]:   search_path: None
[0m16:53:26.335877 [info ] [MainThread]:   keepalives_idle: 0
[0m16:53:26.335877 [info ] [MainThread]:   sslmode: None
[0m16:53:26.335877 [info ] [MainThread]:   sslcert: None
[0m16:53:26.347577 [info ] [MainThread]:   sslkey: None
[0m16:53:26.347577 [info ] [MainThread]:   sslrootcert: None
[0m16:53:26.347577 [info ] [MainThread]:   application_name: dbt
[0m16:53:26.347577 [info ] [MainThread]:   retries: 1
[0m16:53:26.347577 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:53:26.679209 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:53:26.869250 [debug] [MainThread]: Using postgres connection "debug"
[0m16:53:26.885143 [debug] [MainThread]: On debug: select 1 as id
[0m16:53:26.885143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:26.916871 [debug] [MainThread]: SQL status: SELECT 1 in 0.039 seconds
[0m16:53:26.916871 [debug] [MainThread]: On debug: Close
[0m16:53:26.916871 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:53:26.916871 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:53:26.916871 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m16:53:26.916871 [debug] [MainThread]: Command `dbt debug` failed at 16:53:26.916871 after 0.91 seconds
[0m16:53:26.932760 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:53:26.932760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001745925F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174525B5350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174582E7950>]}
[0m16:53:26.932760 [debug] [MainThread]: Flushing usage events
[0m16:53:28.117440 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:40.392684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23D3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23D2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23D3510>]}


============================== 16:53:40.392684 | 6ef8238e-98ef-4d90-a3a8-f01eb7df411b ==============================
[0m16:53:40.392684 [info ] [MainThread]: Running with dbt=1.11.5
[0m16:53:40.392684 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m16:53:40.601668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23E4A10>]}
[0m16:53:40.664772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B9EBF67D0>]}
[0m16:53:40.664772 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:53:40.999060 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m16:53:41.186341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:41.186341 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:53:41.186341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:41.194686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.firmable_dbt.example
[0m16:53:41.215933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA396D610>]}
[0m16:53:41.295041 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:53:41.295041 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:53:41.346504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA3BBBE10>]}
[0m16:53:41.348510 [info ] [MainThread]: Found 2 models, 4 data tests, 464 macros
[0m16:53:41.348510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA3896450>]}
[0m16:53:41.348510 [info ] [MainThread]: 
[0m16:53:41.348510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:41.348510 [info ] [MainThread]: 
[0m16:53:41.348510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:41.358477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m16:53:41.612420 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m16:53:41.612420 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m16:53:41.612420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:41.660021 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.050 seconds
[0m16:53:41.660021 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m16:53:41.660021 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m16:53:41.676027 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.676027 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:53:41.676027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:41.708066 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m16:53:41.708066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ef8238e-98ef-4d90-a3a8-f01eb7df411b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA3858CD0>]}
[0m16:53:41.708066 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:41.708066 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.708066 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:41.708066 [debug] [MainThread]: On master: COMMIT
[0m16:53:41.723724 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:53:41.723724 [debug] [MainThread]: On master: Close
[0m16:53:41.723724 [debug] [Thread-1 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:53:41.723724 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:53:41.723724 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:53:41.723724 [debug] [Thread-4 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:53:41.723724 [info ] [Thread-1 (]: 1 of 4 START test not_null_abr_clean_abn ....................................... [RUN]
[0m16:53:41.723724 [info ] [Thread-2 (]: 2 of 4 START test not_null_abr_clean_normalized_name ........................... [RUN]
[0m16:53:41.723724 [info ] [Thread-3 (]: 3 of 4 START test not_null_commoncrawl_clean_website_url ....................... [RUN]
[0m16:53:41.723724 [info ] [Thread-4 (]: 4 of 4 START test unique_abr_clean_abn ......................................... [RUN]
[0m16:53:41.723724 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m16:53:41.723724 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m16:53:41.723724 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377'
[0m16:53:41.739588 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9'
[0m16:53:41.739588 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:53:41.739588 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:53:41.739588 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:53:41.739588 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:53:41.755542 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:53:41.755542 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:53:41.768604 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:53:41.771360 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:53:41.771360 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:53:41.771360 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:53:41.771360 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:53:41.771360 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:53:41.787358 [debug] [Thread-1 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:53:41.798890 [debug] [Thread-2 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:53:41.803404 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:53:41.803404 [debug] [Thread-4 (]: Writing runtime sql for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:53:41.803404 [debug] [Thread-1 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m16:53:41.803404 [debug] [Thread-2 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m16:53:41.803404 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m16:53:41.803404 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select abn
from "firmable_db"."staging"."abr_clean"
where abn is null



  
  
      
    ) dbt_internal_test
[0m16:53:41.803404 [debug] [Thread-4 (]: Using postgres connection "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m16:53:41.803404 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normalized_name
from "firmable_db"."staging"."abr_clean"
where normalized_name is null



  
  
      
    ) dbt_internal_test
[0m16:53:41.803404 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select website_url
from "firmable_db"."staging"."commoncrawl_clean"
where website_url is null



  
  
      
    ) dbt_internal_test
[0m16:53:41.803404 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:53:41.803404 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    abn as unique_field,
    count(*) as n_records

from "firmable_db"."staging"."abr_clean"
where abn is not null
group by abn
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:53:41.803404 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:53:41.803404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:53:41.803404 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:53:41.869762 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.055 seconds
[0m16:53:41.877793 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: ROLLBACK
[0m16:53:41.877793 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: Close
[0m16:53:41.879799 [info ] [Thread-3 (]: 3 of 4 PASS not_null_commoncrawl_clean_website_url ............................. [[32mPASS[0m in 0.16s]
[0m16:53:41.881548 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m16:53:41.936947 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.124 seconds
[0m16:53:41.936947 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: ROLLBACK
[0m16:53:41.939606 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: Close
[0m16:53:41.939606 [info ] [Thread-1 (]: 1 of 4 PASS not_null_abr_clean_abn ............................................. [[32mPASS[0m in 0.22s]
[0m16:53:41.943222 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m16:53:42.007597 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.200 seconds
[0m16:53:42.007597 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: ROLLBACK
[0m16:53:42.007597 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: Close
[0m16:53:42.007597 [info ] [Thread-2 (]: 2 of 4 PASS not_null_abr_clean_normalized_name ................................. [[32mPASS[0m in 0.28s]
[0m16:53:42.020214 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m16:53:42.070552 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.265 seconds
[0m16:53:42.070552 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: ROLLBACK
[0m16:53:42.070552 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: Close
[0m16:53:42.070552 [info ] [Thread-4 (]: 4 of 4 PASS unique_abr_clean_abn ............................................... [[32mPASS[0m in 0.33s]
[0m16:53:42.086383 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m16:53:42.086383 [debug] [MainThread]: On master: COMMIT
[0m16:53:42.086383 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:42.086383 [debug] [MainThread]: On master: COMMIT
[0m16:53:42.086383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:42.118288 [debug] [MainThread]: SQL status: COMMIT in 0.035 seconds
[0m16:53:42.118288 [debug] [MainThread]: On master: Close
[0m16:53:42.118288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:42.118288 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m16:53:42.118288 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m16:53:42.118288 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m16:53:42.118288 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377' was properly closed.
[0m16:53:42.118288 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m16:53:42.133927 [info ] [MainThread]: 
[0m16:53:42.133927 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:53:42.133927 [debug] [MainThread]: Command end result
[0m16:53:42.150007 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m16:53:42.165728 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m16:53:42.165728 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m16:53:42.165728 [info ] [MainThread]: 
[0m16:53:42.165728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:42.165728 [info ] [MainThread]: 
[0m16:53:42.165728 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:53:42.165728 [debug] [MainThread]: Command `dbt test` succeeded at 16:53:42.165728 after 1.87 seconds
[0m16:53:42.165728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23CFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23CF750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BA23CF890>]}
[0m16:53:42.165728 [debug] [MainThread]: Flushing usage events
[0m16:53:43.408698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:31.186999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF121D32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF15A14110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF159D1810>]}


============================== 17:00:31.202899 | 9674307b-938b-4838-8927-541604de82b9 ==============================
[0m17:00:31.202899 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:00:31.202899 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:00:31.393509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16C20050>]}
[0m17:00:31.456809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF16C94710>]}
[0m17:00:31.456809 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:00:31.790336 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m17:00:31.885826 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:00:31.885826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14A5AE90>]}
[0m17:00:33.079857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF17090810>]}
[0m17:00:33.111367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF173A3550>]}
[0m17:00:33.111367 [info ] [MainThread]: Found 2 models, 4 data tests, 464 macros
[0m17:00:33.111367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF17393A50>]}
[0m17:00:33.121969 [info ] [MainThread]: 
[0m17:00:33.121969 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:33.121969 [info ] [MainThread]: 
[0m17:00:33.121969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:33.128936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m17:00:33.349230 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m17:00:33.349230 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:00:33.349230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:33.396339 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.046 seconds
[0m17:00:33.396339 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m17:00:33.396339 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m17:00:33.403651 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:33.403651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:00:33.403651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:33.443826 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m17:00:33.450333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9674307b-938b-4838-8927-541604de82b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF170AD090>]}
[0m17:00:33.450333 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:33.452339 [debug] [MainThread]: On master: Close
[0m17:00:33.452339 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m17:00:33.452339 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m17:00:33.459612 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m17:00:33.459612 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m17:00:33.459612 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m17:00:33.459612 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m17:00:33.459612 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m17:00:33.471891 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m17:00:33.471891 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m17:00:33.471891 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m17:00:33.474878 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m17:00:33.474878 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m17:00:33.474878 [debug] [Thread-4 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:00:33.474878 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:00:33.474878 [debug] [Thread-1 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:00:33.474878 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:00:33.474878 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m17:00:33.474878 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m17:00:33.474878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.abr_clean, now test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9)
[0m17:00:33.474878 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.commoncrawl_clean, now test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377)
[0m17:00:33.474878 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:00:33.474878 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:00:33.474878 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:00:33.474878 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:00:33.490832 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:00:33.490832 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:00:33.490832 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:00:33.508928 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:00:33.508928 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:00:33.508928 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:00:33.508928 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:00:33.508928 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:00:33.508928 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:00:33.508928 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:00:33.508928 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:00:33.508928 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:00:33.508928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:33.508928 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m17:00:33.508928 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m17:00:33.508928 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377' was properly closed.
[0m17:00:33.522632 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m17:00:33.522632 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m17:00:33.522632 [debug] [MainThread]: Command end result
[0m17:00:33.586120 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:00:33.601978 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:00:33.601978 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m17:00:33.601978 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:00:33.601978 [info ] [MainThread]: Building catalog
[0m17:00:33.617746 [debug] [ThreadPool]: Acquiring new postgres connection 'firmable_db.information_schema'
[0m17:00:33.617746 [debug] [ThreadPool]: Using postgres connection "firmable_db.information_schema"
[0m17:00:33.617746 [debug] [ThreadPool]: On firmable_db.information_schema: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "firmable_db.information_schema"} */

    
    

    select
        'firmable_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('abr_clean')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('commoncrawl_clean')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:00:33.617746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:33.681121 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.056 seconds
[0m17:00:33.681121 [debug] [ThreadPool]: On firmable_db.information_schema: ROLLBACK
[0m17:00:33.681121 [debug] [ThreadPool]: On firmable_db.information_schema: Close
[0m17:00:33.696859 [debug] [MainThread]: Wrote artifact CatalogArtifact to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:00:33.760855 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:00:33.776787 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:00:33.776787 [info ] [MainThread]: Catalog written to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:00:33.776787 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:00:33.776787 after 2.68 seconds
[0m17:00:33.782245 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:00:33.782245 [debug] [MainThread]: Connection 'firmable_db.information_schema' was properly closed.
[0m17:00:33.782245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF14612290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF0EF2F650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF17627F10>]}
[0m17:00:33.784260 [debug] [MainThread]: Flushing usage events
[0m17:00:34.984653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:18.754136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB80A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB8096D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB808490>]}


============================== 17:01:18.759689 | 84d10e59-891e-4a39-b6b5-31dc1b280f6f ==============================
[0m17:01:18.759689 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:01:18.762391 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:01:18.963407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d10e59-891e-4a39-b6b5-31dc1b280f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB460210>]}
[0m17:01:19.026515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d10e59-891e-4a39-b6b5-31dc1b280f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC7FB4950>]}
[0m17:03:42.043889 [error] [MainThread]: Encountered an error:

[0m17:03:42.043889 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:03:42.043889 [debug] [MainThread]: Command `dbt docs serve` failed at 17:03:42.043889 after 143.46 seconds
[0m17:03:42.059721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB6CA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB79FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFCB79F710>]}
[0m17:03:42.061746 [debug] [MainThread]: Flushing usage events
[0m17:03:43.319890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:29.717287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE058C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE058210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE05ADD0>]}


============================== 17:04:29.717287 | 92274551-e281-4681-88c9-3feaa7554e24 ==============================
[0m17:04:29.717287 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:04:29.717287 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:04:29.923183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92274551-e281-4681-88c9-3feaa7554e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BF261B90>]}
[0m17:04:29.986812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92274551-e281-4681-88c9-3feaa7554e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BA7F6750>]}
[0m17:07:41.224942 [error] [MainThread]: Encountered an error:

[0m17:07:41.240729 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:07:41.240729 [debug] [MainThread]: Command `dbt docs serve` failed at 17:07:41.240729 after 191.61 seconds
[0m17:07:41.240729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE0344D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BDFEF790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BE09C290>]}
[0m17:07:41.240729 [debug] [MainThread]: Flushing usage events
[0m17:07:42.599060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:49.061155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C89580B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C895B7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C89583710>]}


============================== 17:07:49.076899 | 013ff5a4-5761-4499-b488-af52846c528f ==============================
[0m17:07:49.076899 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:07:49.076899 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:07:49.283031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C89625390>]}
[0m17:07:49.346542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C85D90C90>]}
[0m17:07:49.346542 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:07:49.701032 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m17:07:49.965939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m17:07:49.965939 [debug] [MainThread]: Partial parsing: added file: firmable_dbt://models\staging\sources.yml
[0m17:07:49.965939 [debug] [MainThread]: Partial parsing: updated file: firmable_dbt://models\staging\commoncrawl_clean.sql
[0m17:07:49.965939 [debug] [MainThread]: Partial parsing: updated file: firmable_dbt://models\staging\abr_clean.sql
[0m17:07:50.520739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8A6A1890>]}
[0m17:07:50.616279 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:07:50.616279 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:07:50.663882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8AEF0A90>]}
[0m17:07:50.663882 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 464 macros
[0m17:07:50.663882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8AB42810>]}
[0m17:07:50.663882 [info ] [MainThread]: 
[0m17:07:50.680012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:07:50.680012 [info ] [MainThread]: 
[0m17:07:50.680012 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:07:50.680012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db'
[0m17:07:50.901472 [debug] [ThreadPool]: Using postgres connection "list_firmable_db"
[0m17:07:50.901472 [debug] [ThreadPool]: On list_firmable_db: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db"} */

    select distinct nspname from pg_namespace
  
[0m17:07:50.901472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:50.964501 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m17:07:50.964501 [debug] [ThreadPool]: On list_firmable_db: Close
[0m17:07:50.964501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m17:07:50.982435 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m17:07:50.982435 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:07:50.982435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:51.027648 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.052 seconds
[0m17:07:51.027648 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m17:07:51.027648 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m17:07:51.043401 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:51.043401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:07:51.043401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:51.090924 [debug] [MainThread]: SQL status: SELECT 3 in 0.045 seconds
[0m17:07:51.090924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8AF19550>]}
[0m17:07:51.090924 [debug] [MainThread]: On master: ROLLBACK
[0m17:07:51.090924 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.090924 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:51.090924 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.090924 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:07:51.090924 [debug] [MainThread]: On master: Close
[0m17:07:51.106728 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m17:07:51.106728 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m17:07:51.106728 [info ] [Thread-1 (]: 1 of 2 START sql view model staging.abr_clean .................................. [RUN]
[0m17:07:51.106728 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m17:07:51.106728 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m17:07:51.106728 [info ] [Thread-2 (]: 2 of 2 START sql view model staging.commoncrawl_clean .......................... [RUN]
[0m17:07:51.121051 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m17:07:51.122799 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m17:07:51.125317 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m17:07:51.125317 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m17:07:51.132619 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.169690 [debug] [Thread-1 (]: Writing runtime sql for node "model.firmable_dbt.abr_clean"
[0m17:07:51.169690 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m17:07:51.169690 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m17:07:51.169690 [debug] [Thread-2 (]: Writing runtime sql for node "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.169690 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */

  create view "firmable_db"."staging"."abr_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from "firmable_db"."staging"."abr_raw"

)

select
    abn,
    initcap(trim(entity_name)) as entity_name,
    lower(regexp_replace(entity_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    entity_type,
    entity_status,
    state,
    postcode
from source
where entity_status = 'ACT'
  and entity_name is not null
  and trim(entity_name) <> ''
  );
[0m17:07:51.169690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:51.169690 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.169690 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */

  create view "firmable_db"."staging"."commoncrawl_clean__dbt_tmp"
    
    
  as (
    with source as (

    select *
    from "firmable_db"."staging"."commoncrawl_raw"

)

select
    website_url,
    initcap(trim(company_name)) as company_name,
    lower(regexp_replace(company_name, '[^a-zA-Z0-9 ]', '', 'g')) as normalized_name,
    industry
from source
where company_name is not null
  );
[0m17:07:51.169690 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:51.233119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.061 seconds
[0m17:07:51.233119 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.059 seconds
[0m17:07:51.246721 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m17:07:51.249287 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.249287 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean" rename to "abr_clean__dbt_backup"
[0m17:07:51.249287 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean" rename to "commoncrawl_clean__dbt_backup"
[0m17:07:51.249287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:07:51.249287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:07:51.260755 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m17:07:51.260755 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.260755 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
alter table "firmable_db"."staging"."abr_clean__dbt_tmp" rename to "abr_clean"
[0m17:07:51.265256 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
alter table "firmable_db"."staging"."commoncrawl_clean__dbt_tmp" rename to "commoncrawl_clean"
[0m17:07:51.265256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:51.265256 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:07:51.280973 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m17:07:51.286853 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m17:07:51.286853 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m17:07:51.286853 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.286853 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: COMMIT
[0m17:07:51.286853 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: COMMIT
[0m17:07:51.286853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:07:51.286853 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:07:51.296971 [debug] [Thread-1 (]: Applying DROP to: "firmable_db"."staging"."abr_clean__dbt_backup"
[0m17:07:51.296971 [debug] [Thread-2 (]: Applying DROP to: "firmable_db"."staging"."commoncrawl_clean__dbt_backup"
[0m17:07:51.309051 [debug] [Thread-1 (]: Using postgres connection "model.firmable_dbt.abr_clean"
[0m17:07:51.309051 [debug] [Thread-2 (]: Using postgres connection "model.firmable_dbt.commoncrawl_clean"
[0m17:07:51.309051 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.abr_clean"} */
drop view if exists "firmable_db"."staging"."abr_clean__dbt_backup" cascade
[0m17:07:51.309051 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "model.firmable_dbt.commoncrawl_clean"} */
drop view if exists "firmable_db"."staging"."commoncrawl_clean__dbt_backup" cascade
[0m17:07:51.312819 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:07:51.312819 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:07:51.323409 [debug] [Thread-1 (]: On model.firmable_dbt.abr_clean: Close
[0m17:07:51.323409 [debug] [Thread-2 (]: On model.firmable_dbt.commoncrawl_clean: Close
[0m17:07:51.328495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B266A10>]}
[0m17:07:51.328495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '013ff5a4-5761-4499-b488-af52846c528f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8B3CC650>]}
[0m17:07:51.328495 [info ] [Thread-1 (]: 1 of 2 OK created sql view model staging.abr_clean ............................. [[32mCREATE VIEW[0m in 0.22s]
[0m17:07:51.328495 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m17:07:51.328495 [info ] [Thread-2 (]: 2 of 2 OK created sql view model staging.commoncrawl_clean ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m17:07:51.328495 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m17:07:51.344513 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.344513 [debug] [MainThread]: Using postgres connection "master"
[0m17:07:51.344513 [debug] [MainThread]: On master: COMMIT
[0m17:07:51.344513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:51.376391 [debug] [MainThread]: SQL status: COMMIT in 0.042 seconds
[0m17:07:51.376391 [debug] [MainThread]: On master: Close
[0m17:07:51.392416 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:51.392416 [debug] [MainThread]: Connection 'list_firmable_db' was properly closed.
[0m17:07:51.392416 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m17:07:51.392416 [debug] [MainThread]: Connection 'model.firmable_dbt.abr_clean' was properly closed.
[0m17:07:51.392416 [debug] [MainThread]: Connection 'model.firmable_dbt.commoncrawl_clean' was properly closed.
[0m17:07:51.392416 [info ] [MainThread]: 
[0m17:07:51.392416 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m17:07:51.392416 [debug] [MainThread]: Command end result
[0m17:07:51.424352 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:07:51.424352 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:07:51.439991 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m17:07:51.439991 [info ] [MainThread]: 
[0m17:07:51.439991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:07:51.439991 [info ] [MainThread]: 
[0m17:07:51.439991 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:07:51.453601 [debug] [MainThread]: Command `dbt run` succeeded at 17:07:51.453601 after 2.47 seconds
[0m17:07:51.455614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8959C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C82B5F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8931A1D0>]}
[0m17:07:51.455614 [debug] [MainThread]: Flushing usage events
[0m17:07:52.669744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:06.340361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021C172290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021BF09D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021C19BBD0>]}


============================== 17:08:06.340361 | ae245803-4729-4fa1-8ae8-14fae6b1e843 ==============================
[0m17:08:06.340361 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:08:06.340361 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:08:06.546131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021D3920D0>]}
[0m17:08:06.609194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020218982A10>]}
[0m17:08:06.609194 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:08:06.942446 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m17:08:07.168969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:07.170974 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:08:07.170974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:07.212933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021D710BD0>]}
[0m17:08:07.244327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021D87B610>]}
[0m17:08:07.244327 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 464 macros
[0m17:08:07.244327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021D7FF210>]}
[0m17:08:07.244327 [info ] [MainThread]: 
[0m17:08:07.260353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:08:07.260353 [info ] [MainThread]: 
[0m17:08:07.260353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:07.260353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m17:08:07.484189 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m17:08:07.484189 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:08:07.484189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:07.531777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.047 seconds
[0m17:08:07.531777 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m17:08:07.531777 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m17:08:07.547511 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:07.547511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:08:07.547511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:07.578979 [debug] [MainThread]: SQL status: SELECT 3 in 0.040 seconds
[0m17:08:07.591397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae245803-4729-4fa1-8ae8-14fae6b1e843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021DAABC50>]}
[0m17:08:07.591397 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:07.591397 [debug] [MainThread]: On master: Close
[0m17:08:07.597080 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m17:08:07.597080 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m17:08:07.597080 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m17:08:07.597080 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m17:08:07.597080 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m17:08:07.597080 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m17:08:07.597080 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m17:08:07.611022 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m17:08:07.611022 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m17:08:07.611022 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m17:08:07.616393 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m17:08:07.616393 [debug] [Thread-4 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:08:07.616393 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m17:08:07.618399 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:08:07.618399 [debug] [Thread-1 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:08:07.618399 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m17:08:07.618399 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:08:07.618399 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m17:08:07.618399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.abr_clean, now test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9)
[0m17:08:07.618399 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:08:07.618399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.commoncrawl_clean, now test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377)
[0m17:08:07.618399 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:08:07.618399 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:08:07.636889 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:08:07.636889 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:08:07.636889 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:08:07.646737 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:08:07.646737 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:08:07.646737 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:08:07.646737 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:08:07.646737 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:08:07.646737 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:08:07.646737 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:08:07.646737 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:08:07.658611 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:08:07.658611 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:08:07.658611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m17:08:07.658611 [debug] [MainThread]: Command end result
[0m17:08:07.785046 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:08:07.785046 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:08:07.805994 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m17:08:07.805994 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:08:07.805994 [info ] [MainThread]: Building catalog
[0m17:08:07.816680 [debug] [ThreadPool]: Acquiring new postgres connection 'firmable_db.information_schema'
[0m17:08:07.832479 [debug] [ThreadPool]: Using postgres connection "firmable_db.information_schema"
[0m17:08:07.832479 [debug] [ThreadPool]: On firmable_db.information_schema: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "firmable_db.information_schema"} */

    
    

    select
        'firmable_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('commoncrawl_raw')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('abr_raw')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('abr_clean')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('commoncrawl_clean')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:08:07.832479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:07.879995 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.049 seconds
[0m17:08:07.879995 [debug] [ThreadPool]: On firmable_db.information_schema: ROLLBACK
[0m17:08:07.879995 [debug] [ThreadPool]: On firmable_db.information_schema: Close
[0m17:08:07.896136 [debug] [MainThread]: Wrote artifact CatalogArtifact to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:08:07.912239 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:08:07.928231 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:08:07.928231 [info ] [MainThread]: Catalog written to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:08:07.928231 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:08:07.928231 after 1.66 seconds
[0m17:08:07.928231 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:08:07.928231 [debug] [MainThread]: Connection 'firmable_db.information_schema' was properly closed.
[0m17:08:07.928231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021570F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021BE288D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002021DB3DE50>]}
[0m17:08:07.928231 [debug] [MainThread]: Flushing usage events
[0m17:08:09.151249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:28.581085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC48C1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC48C26D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC48C0F10>]}


============================== 17:08:28.581085 | ef51d93f-49f8-4011-a257-d15750ffd7f9 ==============================
[0m17:08:28.581085 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:08:28.581085 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:08:28.787649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef51d93f-49f8-4011-a257-d15750ffd7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC38E0210>]}
[0m17:08:28.850924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef51d93f-49f8-4011-a257-d15750ffd7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC10C2C10>]}
[0m17:30:32.474730 [error] [MainThread]: Encountered an error:

[0m17:30:32.490451 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:30:32.506173 [debug] [MainThread]: Command `dbt docs serve` failed at 17:30:32.506173 after 1324.01 seconds
[0m17:30:32.506173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC4941E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC4940150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FC48BF5D0>]}
[0m17:30:32.506173 [debug] [MainThread]: Flushing usage events
[0m17:30:33.878846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:40.826913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF98C3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF98C2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF98C08D0>]}


============================== 17:30:40.833264 | 779e0166-8d23-41d6-a361-86b20350ab93 ==============================
[0m17:30:40.833264 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:30:40.833264 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:30:41.039851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFAA9F850>]}
[0m17:30:41.103413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF60C0A50>]}
[0m17:30:41.103413 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:30:41.437743 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m17:30:41.643398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:41.659065 [debug] [MainThread]: Partial parsing: updated file: firmable_dbt://models\staging\schema.yml
[0m17:30:42.119850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFAB5C790>]}
[0m17:30:42.168044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFA9B2650>]}
[0m17:30:42.168044 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 464 macros
[0m17:30:42.168044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFAF6BF90>]}
[0m17:30:42.183709 [info ] [MainThread]: 
[0m17:30:42.183709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:42.183709 [info ] [MainThread]: 
[0m17:30:42.183709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:42.183709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m17:30:42.403700 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m17:30:42.403700 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:30:42.403700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:42.483621 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.081 seconds
[0m17:30:42.483621 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m17:30:42.483621 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m17:30:42.499374 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:42.499374 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:30:42.499374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:42.557602 [debug] [MainThread]: SQL status: SELECT 3 in 0.055 seconds
[0m17:30:42.562777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779e0166-8d23-41d6-a361-86b20350ab93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF904BED0>]}
[0m17:30:42.562777 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:42.562777 [debug] [MainThread]: On master: Close
[0m17:30:42.562777 [debug] [Thread-1 (]: Began running node model.firmable_dbt.abr_clean
[0m17:30:42.562777 [debug] [Thread-2 (]: Began running node model.firmable_dbt.commoncrawl_clean
[0m17:30:42.562777 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.firmable_dbt.abr_clean'
[0m17:30:42.562777 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.firmable_dbt.commoncrawl_clean'
[0m17:30:42.562777 [debug] [Thread-1 (]: Began compiling node model.firmable_dbt.abr_clean
[0m17:30:42.562777 [debug] [Thread-2 (]: Began compiling node model.firmable_dbt.commoncrawl_clean
[0m17:30:42.578498 [debug] [Thread-1 (]: Writing injected SQL for node "model.firmable_dbt.abr_clean"
[0m17:30:42.586738 [debug] [Thread-2 (]: Writing injected SQL for node "model.firmable_dbt.commoncrawl_clean"
[0m17:30:42.586738 [debug] [Thread-1 (]: Began executing node model.firmable_dbt.abr_clean
[0m17:30:42.586738 [debug] [Thread-1 (]: Finished running node model.firmable_dbt.abr_clean
[0m17:30:42.586738 [debug] [Thread-2 (]: Began executing node model.firmable_dbt.commoncrawl_clean
[0m17:30:42.586738 [debug] [Thread-4 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:30:42.586738 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:30:42.586738 [debug] [Thread-2 (]: Finished running node model.firmable_dbt.commoncrawl_clean
[0m17:30:42.594238 [debug] [Thread-1 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:30:42.594238 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m17:30:42.594238 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m17:30:42.594238 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:30:42.594238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.abr_clean, now test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9)
[0m17:30:42.594238 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:30:42.594238 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:30:42.594238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.firmable_dbt.commoncrawl_clean, now test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377)
[0m17:30:42.594238 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:30:42.612078 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:30:42.612078 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:30:42.612078 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:30:42.612078 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:30:42.612078 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:30:42.626133 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:30:42.626133 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:30:42.626133 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:30:42.626133 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:30:42.626133 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:30:42.626133 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:30:42.626133 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:30:42.626133 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:30:42.626133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:42.626133 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m17:30:42.626133 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m17:30:42.626133 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377' was properly closed.
[0m17:30:42.641941 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m17:30:42.641941 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m17:30:42.641941 [debug] [MainThread]: Command end result
[0m17:30:42.721577 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:30:42.721577 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:30:42.737362 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m17:30:42.737362 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:30:42.737362 [info ] [MainThread]: Building catalog
[0m17:30:42.753380 [debug] [ThreadPool]: Acquiring new postgres connection 'firmable_db.information_schema'
[0m17:30:42.753380 [debug] [ThreadPool]: Using postgres connection "firmable_db.information_schema"
[0m17:30:42.753380 [debug] [ThreadPool]: On firmable_db.information_schema: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "firmable_db.information_schema"} */

    
    

    select
        'firmable_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('commoncrawl_clean')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('abr_raw')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('abr_clean')) or (upper(sch.nspname) = upper('staging') and
           upper(tbl.relname) = upper('commoncrawl_raw')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:30:42.769164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:42.801077 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.045 seconds
[0m17:30:42.817024 [debug] [ThreadPool]: On firmable_db.information_schema: ROLLBACK
[0m17:30:42.817024 [debug] [ThreadPool]: On firmable_db.information_schema: Close
[0m17:30:42.817024 [debug] [MainThread]: Wrote artifact CatalogArtifact to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:30:42.848825 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:30:42.848825 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:30:42.848825 [info ] [MainThread]: Catalog written to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\catalog.json
[0m17:30:42.848825 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:30:42.848825 after 2.12 seconds
[0m17:30:42.859700 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:30:42.859700 [debug] [MainThread]: Connection 'firmable_db.information_schema' was properly closed.
[0m17:30:42.859700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2DFF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2B35190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF9929BD0>]}
[0m17:30:42.861706 [debug] [MainThread]: Flushing usage events
[0m17:30:44.041434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:31:06.944183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91BB3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91BDE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91BB22D0>]}


============================== 17:31:06.944183 | 6e278129-bf7c-485e-a467-8ac1d4ff5e5d ==============================
[0m17:31:06.944183 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:31:06.944183 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:31:07.133954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e278129-bf7c-485e-a467-8ac1d4ff5e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE92DAA010>]}
[0m17:31:07.197314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e278129-bf7c-485e-a467-8ac1d4ff5e5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE8E3C2E90>]}
[0m17:44:41.438271 [error] [MainThread]: Encountered an error:

[0m17:44:41.438271 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Sharan Kalyan\Anaconda3\envs\firmable-pipeline-311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:44:41.438271 [debug] [MainThread]: Command `dbt docs serve` failed at 17:44:41.438271 after 814.58 seconds
[0m17:44:41.450525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91C31E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91C30350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE91BAFA50>]}
[0m17:44:41.450525 [debug] [MainThread]: Flushing usage events
[0m17:44:42.718498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:08.257037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A3273B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A3270E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A3273C90>]}


============================== 17:45:08.261865 | 4619fbb4-3924-4e7a-9656-ccf56cbbc91a ==============================
[0m17:45:08.261865 [info ] [MainThread]: Running with dbt=1.11.5
[0m17:45:08.261865 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Sharan Kalyan\\.dbt', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'G:\\SharanKalyan\\Interview-Kit\\Firmable\\firmable_dbt\\logs'}
[0m17:45:08.471103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A29F9A50>]}
[0m17:45:08.534207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49FA7A750>]}
[0m17:45:08.536212 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m17:45:08.872259 [debug] [MainThread]: checksum: 917838c7befe257b9b22a76c21e5785f6f23ac83ef0336e2870f03c9c3f28402, vars: {}, profile: , target: , version: 1.11.5
[0m17:45:09.094287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:09.094287 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m17:45:09.094287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:09.139877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A46F8210>]}
[0m17:45:09.219129 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:45:09.234898 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:45:09.278207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A4B13AD0>]}
[0m17:45:09.280216 [info ] [MainThread]: Found 2 models, 4 data tests, 2 sources, 464 macros
[0m17:45:09.280216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A4988510>]}
[0m17:45:09.282235 [info ] [MainThread]: 
[0m17:45:09.292519 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:09.298052 [info ] [MainThread]: 
[0m17:45:09.298052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:09.298052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_firmable_db_staging'
[0m17:45:09.552952 [debug] [ThreadPool]: Using postgres connection "list_firmable_db_staging"
[0m17:45:09.552952 [debug] [ThreadPool]: On list_firmable_db_staging: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "list_firmable_db_staging"} */
select
      'firmable_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'firmable_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'
  
[0m17:45:09.552952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:09.600465 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.051 seconds
[0m17:45:09.600465 [debug] [ThreadPool]: On list_firmable_db_staging: ROLLBACK
[0m17:45:09.600465 [debug] [ThreadPool]: On list_firmable_db_staging: Close
[0m17:45:09.616272 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.616272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:45:09.616272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:09.665801 [debug] [MainThread]: SQL status: SELECT 3 in 0.042 seconds
[0m17:45:09.665801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4619fbb4-3924-4e7a-9656-ccf56cbbc91a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A4B22190>]}
[0m17:45:09.665801 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:09.665801 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.665801 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:09.665801 [debug] [MainThread]: On master: COMMIT
[0m17:45:09.665801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:45:09.665801 [debug] [MainThread]: On master: Close
[0m17:45:09.674562 [debug] [Thread-1 (]: Began running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:45:09.674562 [debug] [Thread-2 (]: Began running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:45:09.679587 [debug] [Thread-4 (]: Began running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:45:09.674562 [debug] [Thread-3 (]: Began running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:45:09.679587 [info ] [Thread-1 (]: 1 of 4 START test not_null_abr_clean_abn ....................................... [RUN]
[0m17:45:09.679587 [info ] [Thread-2 (]: 2 of 4 START test not_null_abr_clean_normalized_name ........................... [RUN]
[0m17:45:09.679587 [info ] [Thread-4 (]: 4 of 4 START test unique_abr_clean_abn ......................................... [RUN]
[0m17:45:09.679587 [info ] [Thread-3 (]: 3 of 4 START test not_null_commoncrawl_clean_website_url ....................... [RUN]
[0m17:45:09.679587 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966'
[0m17:45:09.679587 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91'
[0m17:45:09.679587 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9'
[0m17:45:09.679587 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377'
[0m17:45:09.679587 [debug] [Thread-1 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:45:09.679587 [debug] [Thread-2 (]: Began compiling node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:45:09.679587 [debug] [Thread-4 (]: Began compiling node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:45:09.679587 [debug] [Thread-3 (]: Began compiling node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:45:09.695719 [debug] [Thread-1 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:45:09.711729 [debug] [Thread-2 (]: Writing injected SQL for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:45:09.711729 [debug] [Thread-4 (]: Writing injected SQL for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:45:09.724832 [debug] [Thread-3 (]: Writing injected SQL for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:45:09.724832 [debug] [Thread-1 (]: Began executing node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:45:09.724832 [debug] [Thread-2 (]: Began executing node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:45:09.727704 [debug] [Thread-4 (]: Began executing node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:45:09.743546 [debug] [Thread-1 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:45:09.743546 [debug] [Thread-3 (]: Began executing node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:45:09.743546 [debug] [Thread-2 (]: Writing runtime sql for node "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:45:09.743546 [debug] [Thread-4 (]: Writing runtime sql for node "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:45:09.759298 [debug] [Thread-1 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"
[0m17:45:09.759298 [debug] [Thread-3 (]: Writing runtime sql for node "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:45:09.759298 [debug] [Thread-2 (]: Using postgres connection "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"
[0m17:45:09.759298 [debug] [Thread-4 (]: Using postgres connection "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"
[0m17:45:09.759298 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select abn
from "firmable_db"."staging"."abr_clean"
where abn is null



  
  
      
    ) dbt_internal_test
[0m17:45:09.759298 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select normalized_name
from "firmable_db"."staging"."abr_clean"
where normalized_name is null



  
  
      
    ) dbt_internal_test
[0m17:45:09.759298 [debug] [Thread-3 (]: Using postgres connection "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"
[0m17:45:09.759298 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    abn as unique_field,
    count(*) as n_records

from "firmable_db"."staging"."abr_clean"
where abn is not null
group by abn
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:45:09.759298 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:09.759298 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:45:09.759298 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: /* {"app": "dbt", "dbt_version": "1.11.5", "profile_name": "firmable_dbt", "target_name": "dev", "node_id": "test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select website_url
from "firmable_db"."staging"."commoncrawl_clean"
where website_url is null



  
  
      
    ) dbt_internal_test
[0m17:45:09.759298 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:45:09.759298 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:45:09.841037 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.071 seconds
[0m17:45:09.849070 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: ROLLBACK
[0m17:45:09.851077 [debug] [Thread-3 (]: On test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377: Close
[0m17:45:09.853085 [info ] [Thread-3 (]: 3 of 4 PASS not_null_commoncrawl_clean_website_url ............................. [[32mPASS[0m in 0.17s]
[0m17:45:09.854835 [debug] [Thread-3 (]: Finished running node test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377
[0m17:45:10.059810 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.297 seconds
[0m17:45:10.059810 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.297 seconds
[0m17:45:10.059810 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: ROLLBACK
[0m17:45:10.059810 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: ROLLBACK
[0m17:45:10.059810 [debug] [Thread-1 (]: On test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966: Close
[0m17:45:10.059810 [debug] [Thread-2 (]: On test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91: Close
[0m17:45:10.059810 [info ] [Thread-1 (]: 1 of 4 PASS not_null_abr_clean_abn ............................................. [[32mPASS[0m in 0.38s]
[0m17:45:10.059810 [debug] [Thread-1 (]: Finished running node test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966
[0m17:45:10.059810 [info ] [Thread-2 (]: 2 of 4 PASS not_null_abr_clean_normalized_name ................................. [[32mPASS[0m in 0.38s]
[0m17:45:10.075690 [debug] [Thread-2 (]: Finished running node test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91
[0m17:45:10.107164 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.341 seconds
[0m17:45:10.107164 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: ROLLBACK
[0m17:45:10.107164 [debug] [Thread-4 (]: On test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9: Close
[0m17:45:10.107164 [info ] [Thread-4 (]: 4 of 4 PASS unique_abr_clean_abn ............................................... [[32mPASS[0m in 0.43s]
[0m17:45:10.107164 [debug] [Thread-4 (]: Finished running node test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9
[0m17:45:10.107164 [debug] [MainThread]: On master: COMMIT
[0m17:45:10.107164 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:10.107164 [debug] [MainThread]: On master: COMMIT
[0m17:45:10.122877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:10.154498 [debug] [MainThread]: SQL status: COMMIT in 0.039 seconds
[0m17:45:10.154498 [debug] [MainThread]: On master: Close
[0m17:45:10.154498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:10.154498 [debug] [MainThread]: Connection 'list_firmable_db_staging' was properly closed.
[0m17:45:10.154498 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_abn.c08a0e5966' was properly closed.
[0m17:45:10.154498 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_abr_clean_normalized_name.f6b3283d91' was properly closed.
[0m17:45:10.154498 [debug] [MainThread]: Connection 'test.firmable_dbt.unique_abr_clean_abn.1bcb22c3a9' was properly closed.
[0m17:45:10.154498 [debug] [MainThread]: Connection 'test.firmable_dbt.not_null_commoncrawl_clean_website_url.e4da6a7377' was properly closed.
[0m17:45:10.154498 [info ] [MainThread]: 
[0m17:45:10.154498 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m17:45:10.170134 [debug] [MainThread]: Command end result
[0m17:45:10.201667 [debug] [MainThread]: Wrote artifact WritableManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\manifest.json
[0m17:45:10.201667 [debug] [MainThread]: Wrote artifact SemanticManifest to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\semantic_manifest.json
[0m17:45:10.213801 [debug] [MainThread]: Wrote artifact RunExecutionResult to G:\SharanKalyan\Interview-Kit\Firmable\firmable_dbt\target\run_results.json
[0m17:45:10.213801 [info ] [MainThread]: 
[0m17:45:10.213801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:10.213801 [info ] [MainThread]: 
[0m17:45:10.217453 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:45:10.222665 [debug] [MainThread]: Command `dbt test` succeeded at 17:45:10.222665 after 2.06 seconds
[0m17:45:10.222665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A326F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A326F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49C574F90>]}
[0m17:45:10.222665 [debug] [MainThread]: Flushing usage events
[0m17:45:11.505001 [debug] [MainThread]: An error was encountered while trying to flush usage events
